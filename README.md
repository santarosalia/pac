# MapleStory Packet Analyzer

λ©”μ΄ν”μ¤ν† λ¦¬ ν¨ν‚· λ¶„μ„κΈ° - κ³ μ„±λ¥ ν¨ν‚· κ°μ§€, λ³µνΈν™” λ° λ‚΄μ© μ¶”μ¶ λ„κµ¬

## μ£Όμ” κΈ°λ¥

### π” ν¨ν‚· μΊ΅μ² λ° λ¶„μ„
- μ‹¤μ‹κ°„ λ„¤νΈμ›ν¬ ν¨ν‚· λ¨λ‹ν„°λ§
- ν”„λ΅μ„Έμ¤λ³„ ν¬νΈ μλ™ κ°μ§€
- ν¨ν‚· λ‚΄μ© λ¶„μ„ λ° λ¶„λ¥
- μμ‹¬μ¤λ¬μ΄ ν¨ν„΄ κ²€μ¶

### π” MapleStory ν¨ν‚· λ³µνΈν™”
- **AES-OFB λ³µνΈν™”**: MapleStoryμ μ£Όμ” μ•”νΈν™” λ°©μ‹
- **Shanda λ³µνΈν™”**: Global/EU μ„λ²„μ© μ¶”κ°€ λ³΄μ•
- **λ²„μ „λ³„ ν‚¤ κ΄€λ¦¬**: v118 μ΄μ „ μ •μ  ν‚¤ λ° v120+ μ΄ν›„ λ™μ  ν‚¤ μ§€μ›
- **ν¨ν‚· ν—¤λ” νμ‹±**: 4λ°”μ΄νΈ ν—¤λ” λ° 2λ°”μ΄νΈ Opcode λ¶„μ„

### π“ λ°μ΄ν„° νμ‹±
- MapleStory λ°μ΄ν„° νƒ€μ… μ§€μ› (Byte, Short, Int, Long, String)
- λΉ„νΈ ν•„λ“ λ¶„μ„ (λ²„ν”„ μ¤νƒ― λ“±)
- 16μ§„μ/ASCII μ΄μ¤‘ μ¶λ ¥
- λ¬Έμμ—΄ μ¶”μ¶ (UTF-8, CP949, EUC-KR μ§€μ›)

## μ„¤μΉ λ°©λ²•

```bash
# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt

# λλ” κ°λ³„ μ„¤μΉ
pip install psutil scapy pycryptodome
```

## μ‚¬μ© λ°©λ²•

```bash
python maplestory_packet_analyzer.py
```

### μ„¤μ • μµμ…

1. **MapleStory λ²„μ „ μ„¤μ •**: λ³µνΈν™”μ— μ‚¬μ©ν•  λ²„μ „ μ„ νƒ
2. **μ•”νΈν™” ν‚¤ μ„¤μ •**: μ‚¬μ©μ μ •μ IV μ„¤μ • (μ„ νƒμ‚¬ν•­)
3. **ν”„λ΅μ„Έμ¤ μ΄λ¦„ μ…λ ¥**: μΊ΅μ²ν•  MapleStory ν”„λ΅μ„Έμ¤ μ§€μ •

## MapleStory ν¨ν‚· κµ¬μ΅°

### ν¨ν‚· ν•μ‹
```
[4 bytes] ν¨ν‚· κΈΈμ΄ (Little Endian)
[2 bytes] Opcode (μ‘μ—… μ½”λ“)
[N bytes] νμ΄λ΅λ“ λ°μ΄ν„°
```

### μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹
- **AES-OFB**: 256λΉ„νΈ ν‚¤, 32λ°”μ΄νΈ
- **Shanda**: XOR κΈ°λ° μ¶”κ°€ λ³΄μ•
- **λ²„μ „λ³„ ν‚¤**: v118 μ΄μ „ μ •μ , v120+ μ΄ν›„ λ™μ 

### λ°μ΄ν„° νƒ€μ…
- **Byte**: 1λ°”μ΄νΈ
- **Short**: 2λ°”μ΄νΈ (Little Endian)
- **Int**: 4λ°”μ΄νΈ (Little Endian)
- **Long**: 8λ°”μ΄νΈ (Little Endian)
- **String**: 2λ°”μ΄νΈ κΈΈμ΄ + λ¬Έμμ—΄ λ°μ΄ν„°

## λ΅κ·Έ μ¶λ ¥ μμ‹

```
=== ν¨ν‚· λ¶„μ„ κ²°κ³Ό ===
μ‹κ°„: 2024-01-01 12:00:00
μ†μ¤: 192.168.1.100:12345
λ©μ μ§€: 192.168.1.200:8080
ν”„λ΅ν† μ½: TCP
ν¬κΈ°: 128 bytes
νƒ€μ…: maplestory_packet
ν¨ν„΄: movement, combat

=== ν¨ν‚· κµ¬μ΅° ===
κΈΈμ΄: 120 bytes
Opcode: 0x1234 (4660)
νμ΄λ΅λ“ ν¬κΈ°: 120 bytes

λ³µνΈν™”: μ„±κ³µ

=== νμ‹±λ λ°μ΄ν„° ===
  byte: 1 (0x01)
  short: 12345 (0x3039)
  int: 987654321 (0x3ADE68B1)
  string: 'player_name' ('player_name')

=== λΉ„νΈ ν•„λ“ ===
  λ°”μ΄νΈ 0: 0x68 (0b01101000) - μ„¤μ •λ λΉ„νΈ: [3, 5, 6]
```

## μ£Όμμ‚¬ν•­

- μ΄ λ„κµ¬λ” κµμ΅ λ° μ—°κµ¬ λ©μ μΌλ΅λ§ μ‚¬μ©ν•μ„Έμ”
- μ‹¤μ  κ²μ„ μ„λ²„μ— λ€ν• λ¬΄λ‹¨ μ ‘κ·Όμ€ κΈμ§€λ©λ‹λ‹¤
- κ°μΈμ •λ³΄ λ³΄νΈλ¥Ό μ„ν•΄ λ―Όκ°ν• λ°μ΄ν„°λ” μ£Όμν•΄μ„ λ‹¤λ£¨μ„Έμ”

## λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” κµμ΅ λ©μ μΌλ΅ μ μ‘λμ—μµλ‹λ‹¤.
