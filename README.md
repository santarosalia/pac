# 메이플스토리 패킷 분석기

고성능 패킷 감지 및 내용 추출 도구입니다. 메이플스토리 게임의 네트워크 통신을 실시간으로 분석하고 패킷 내용을 추출합니다.

## 주요 기능

- **실시간 패킷 캡처**: 메이플스토리 프로세스의 네트워크 통신을 실시간으로 감지
- **고성능 처리**: 멀티스레딩을 통한 비동기 패킷 처리
- **패턴 분석**: 로그인, 채팅, 이동, 전투 등 다양한 패킷 패턴 자동 감지
- **문자열 추출**: 다양한 인코딩(UTF-8, CP949, EUC-KR)으로 문자열 자동 추출
- **의심스러운 패킷 감지**: 해킹, 봇 등 의심스러운 패킷 패턴 자동 감지
- **상세한 로깅**: 패킷 분석 결과를 파일과 콘솔에 동시 출력
- **통계 기능**: 실시간 패킷 통계 및 히스토리 관리

## 설치 방법

### 1. Python 환경 확인

Python 3.7 이상이 필요합니다.

### 2. 의존성 패키지 설치

```bash
pip install -r requirements.txt
```

또는 개별 설치:

```bash
pip install psutil>=5.9.0
pip install scapy>=2.5.0
```

### 3. 관리자 권한 실행

패킷 캡처를 위해 관리자 권한으로 실행해야 합니다.

## 사용 방법

### 기본 실행

```bash
python maplestory_packet_analyzer.py
```

### 실행 과정

1. 스크립트 실행
2. 캡처할 프로세스 이름 입력 (예: `MapleStory`)
3. 자동으로 해당 프로세스의 포트를 찾아 캡처 시작
4. Ctrl+C로 종료

### 출력 예시

```
=== 패킷 분석 결과 ===
시간: 2024-01-15 14:30:25.123456
소스: 192.168.1.100:12345
목적지: 203.248.252.2:8484
프로토콜: TCP
크기: 156 bytes
타입: data
패턴: chat, movement
의심스러움: 아니오

추출된 문자열:
  1. Hello World
  2. Player123
  3. /move 100 200

원시 데이터:
0000: 48 65 6C 6C 6F 20 57 6F 72 6C 64 00 00 00 00 00  Hello World.....
0010: 50 6C 61 79 65 72 31 32 33 00 00 00 00 00 00 00  Player123.......
```

## 고급 기능

### 패턴 감지

다음 패턴들을 자동으로 감지합니다:

- **login**: 로그인 관련 패킷
- **chat**: 채팅 메시지
- **movement**: 캐릭터 이동
- **combat**: 전투 관련
- **inventory**: 인벤토리 조작
- **trade**: 거래 관련
- **guild**: 길드 관련
- **party**: 파티 관련

### 의심스러운 패킷 감지

- 연속된 null bytes (4개 이상)
- 연속된 0xFF bytes (4개 이상)
- 해킹/봇 관련 키워드

### 로그 파일

분석 결과는 `maplestory_packets.log` 파일에 저장됩니다.

## 주의사항

⚠️ **법적 고지사항**

- 이 도구는 교육 및 연구 목적으로만 사용하세요
- 게임 이용약관을 준수하세요
- 불법적인 용도로 사용하지 마세요
- 개인정보 보호에 주의하세요

### 시스템 요구사항

- Windows 10/11
- Python 3.7+
- 관리자 권한
- 네트워크 인터페이스 접근 권한

### 성능 최적화

- 대용량 패킷 처리 시 메모리 사용량 주의
- 30초마다 통계 출력으로 성능 모니터링
- 패킷 큐 크기: 10,000개 (자동 오래된 패킷 제거)

## 문제 해결

### 포트를 찾을 수 없는 경우

1. 메이플스토리가 실행 중인지 확인
2. 프로세스 이름을 정확히 입력했는지 확인
3. 관리자 권한으로 실행했는지 확인

### 패킷이 캡처되지 않는 경우

1. 방화벽 설정 확인
2. 안티바이러스 프로그램의 네트워크 모니터링 비활성화
3. 네트워크 드라이버 업데이트

### 성능 문제

1. 패킷 큐 크기 조정
2. 로그 레벨 조정
3. 불필요한 패턴 필터링

## 라이선스

이 프로젝트는 교육 목적으로만 제공됩니다. 상업적 사용은 금지됩니다.

## 기여

버그 리포트나 기능 제안은 이슈로 등록해주세요.

---

**⚠️ 경고**: 이 도구를 사용하기 전에 관련 법규와 게임 이용약관을 반드시 확인하세요.
